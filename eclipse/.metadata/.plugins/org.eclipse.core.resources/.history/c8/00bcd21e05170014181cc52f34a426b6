package com.callumhutchy.runecraft2.items;

import handler.ExtendedPlayer;
import net.minecraft.client.Minecraft;
import net.minecraft.entity.DataWatcher;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.item.ItemStack;
import net.minecraft.world.World;

import com.callumhutchy.runecraft2.Runecraft2;
import com.callumhutchy.runecraft2.client.gui.GuiSpellBook;
import com.callumhutchy.runecraft2.spells.tileentities.TileEntityAirStrike;
import com.callumhutchy.runecraft2.spells.tileentities.TileEntityEarthStrike;
import com.callumhutchy.runecraft2.spells.tileentities.TileEntityFireStrike;
import com.callumhutchy.runecraft2.spells.tileentities.TileEntityWaterStrike;

import cpw.mods.fml.relauncher.Side;
import cpw.mods.fml.relauncher.SideOnly;

public class Staff extends BaseMagicItem {

	public String	staffElement;
	public int		runesProvided;

	public Staff(String unlocalisedName, int maxSize, String type, int numberOfRunesProvided) {
		super(unlocalisedName, maxSize);
		staffElement = type;
		runesProvided = numberOfRunesProvided;

	}

	@SideOnly(Side.CLIENT)
	public boolean isFull3D() {
		return true;
	}

	public ItemStack onItemRightClick(ItemStack item, World world, EntityPlayer player) {
		ExtendedPlayer props = ExtendedPlayer.get(player);
		DataWatcher dw = player.getDataWatcher();
		int MagicLevel = dw.getWatchableObjectInt(20);
		System.out.println(props.currentSpell);
		if (props.currentSpell == "airstrike") {
			if (player.capabilities.isCreativeMode || runesProvided >= 1 && staffElement == "air" || player.inventory.consumeInventoryItem(Items.airRune)) {
				world.playSoundAtEntity(player, "random.bow", 0.5F, 0.4F / (itemRand.nextFloat() * 0.4F + 0.8F));
				if (!world.isRemote) {

					world.spawnEntityInWorld(new TileEntityAirStrike(world,player));
					props.currentMagicExp++;
					Minecraft.getMinecraft().thePlayer.sendChatMessage("Your Magic increased by 1. It is now " + props.currentMagicExp + "/" + props.maxSkill);
				}
			}

		}
		if(props.currentSpell == "hometeleport"){
				player.setLocationAndAngles(props.currentHomeTPx, props.currentHomeTPy, props.currentHomeTPz, 1.0f, 1.0f);
				Minecraft.getMinecraft().thePlayer.sendChatMessage("You have set your home teleport.");
		}
		if (props.currentSpell == "waterstrike") {
			if (player.capabilities.isCreativeMode || runesProvided >= 1 && staffElement == "water" || player.inventory.consumeInventoryItem(Items.waterRune)) {
				world.playSoundAtEntity(player, "random.bow", 0.5F, 0.4F / (itemRand.nextFloat() * 0.4F + 0.8F));
				if (!world.isRemote) {

					world.spawnEntityInWorld(new TileEntityWaterStrike(world, player));
					props.currentMagicExp++;
					Minecraft.getMinecraft().thePlayer.sendChatMessage("Your Magic increased by 1. It is now " + props.currentMagicExp + "/" + props.maxSkill);
				}
			}

		}
		if (props.currentSpell == "earthstrike") {
			if (player.capabilities.isCreativeMode || runesProvided >= 1 && staffElement == "earth" || player.inventory.consumeInventoryItem(Items.earthRune)) {
				world.playSoundAtEntity(player, "random.bow", 0.5F, 0.4F / (itemRand.nextFloat() * 0.4F + 0.8F));
				if (!world.isRemote) {

					world.spawnEntityInWorld(new TileEntityEarthStrike(world, player));
					props.currentMagicExp++;
					Minecraft.getMinecraft().thePlayer.sendChatMessage("Your Magic increased by 1. It is now " + props.currentMagicExp + "/" + props.maxSkill);
				}
			}

		}
		if (props.currentSpell == "firestrike") {
			if (player.capabilities.isCreativeMode || runesProvided >= 1 && staffElement == "fire" || player.inventory.consumeInventoryItem(Items.fireRune)) {
				world.playSoundAtEntity(player, "random.bow", 0.5F, 0.4F / (itemRand.nextFloat() * 0.4F + 0.8F));
				if (!world.isRemote) {

					world.spawnEntityInWorld(new TileEntityFireStrike(world, player));
					props.currentMagicExp++;
					Minecraft.getMinecraft().thePlayer.sendChatMessage("Your Magic increased by 1. It is now " + props.currentMagicExp + "/" + props.maxSkill);
				}
			}

		}
		dw.updateObject(20, MagicLevel);
		return item;
	}


}
